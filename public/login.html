<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Login | Smart Clinic OPD</title>
    <link rel="icon" href="/images/logo.png" type="image/png">
    <link rel="stylesheet" href="css/landing.css">
    <link rel="stylesheet" href="css/transitions.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body class="login-page">
    <div class="login-card">
        <img src="/images/logo.png" alt="Logo" class="login-logo">
        <h2>Welcome Back</h2>
        <p>Enter credentials to access the Dashboard.</p>
        <div class="demo-badge">
            <i class="fa-solid fa-info-circle"></i>
            <b>Demo Mode:</b> Credentials pre-filled for easy access.
        </div>
        <form onsubmit="handleLogin(event)">
            <div class="input-group">
                <i class="fa-solid fa-user"></i>
                <input type="text" id="username" class="form-control" placeholder="Username" value="admin" required>
            </div>
            <div class="input-group">
                <i class="fa-solid fa-lock"></i>
                <input type="password" id="password" class="form-control" placeholder="Password" value="123" required>
            </div>
            <button type="submit" class="btn-login">Login Securely</button>
            <div id="error-box" class="error-msg">
                <i class="fa-solid fa-circle-exclamation"></i> Invalid Credentials
            </div>
        </form>
        <a href="/" class="back-link"><i class="fa-solid fa-arrow-left" style="margin-top: 3px;"></i> Back to
            Website</a>
    </div>
    <script>
        async function handleLogin(e) {
            e.preventDefault();
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;
            const errorBox = document.getElementById('error-box');
            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: user, password: pass })
                });
                const data = await response.json();
                if (data.success) {
                    localStorage.setItem('smartOpdAuth', 'true');
                    window.location.href = 'admin.html';
                } else {
                    throw new Error('Invalid');
                }
            } catch (err) {
                errorBox.style.display = 'block';
                document.querySelector('.login-card').animate([
                    { transform: 'translateX(0)' }, { transform: 'translateX(-10px)' }, { transform: 'translateX(10px)' }, { transform: 'translateX(0)' }
                ], { duration: 300 });
            }
        }
    </script>
    <script src="js/transitions.js"></script>
</body>

</html>